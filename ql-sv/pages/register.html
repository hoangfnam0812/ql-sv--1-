<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ƒêƒÉng k√Ω - H·ªá th·ªëng Qu·∫£n l√Ω Sinh vi√™n</title>
    <link rel="stylesheet" href="../css/style.css">
</head>
<body>
    <div class="auth-container">
        <div class="auth-box">
            <h2>üìù ƒêƒÉng K√Ω T√†i Kho·∫£n</h2>
            <p>T·∫°o t√†i kho·∫£n sinh vi√™n m·ªõi</p>
            
            <div id="alertMessage" class="alert"></div>

            <form id="registerForm">
                <div class="form-group">
                    <label for="studentId">M√£ sinh vi√™n *</label>
                    <input 
                        type="text" 
                        id="studentId" 
                        name="studentId" 
                        placeholder="VD: SV001"
                        required
                    >
                </div>

                <div class="form-group">
                    <label for="fullName">H·ªç v√† t√™n *</label>
                    <input 
                        type="text" 
                        id="fullName" 
                        name="fullName" 
                        placeholder="Nguy·ªÖn VƒÉn A"
                        required
                    >
                </div>

                <div class="form-group">
                    <label for="email">Email *</label>
                    <input 
                        type="email" 
                        id="email" 
                        name="email" 
                        placeholder="example@student.com"
                        required
                    >
                </div>

                <div class="form-group">
                    <label for="phone">S·ªë ƒëi·ªán tho·∫°i</label>
                    <input 
                        type="tel" 
                        id="phone" 
                        name="phone" 
                        placeholder="0123456789"
                    >
                </div>

                <div class="form-group">
                    <label for="gender">Gi·ªõi t√≠nh</label>
                    <select id="gender" name="gender">
                        <option value="">-- Ch·ªçn gi·ªõi t√≠nh --</option>
                        <option value="Nam">Nam</option>
                        <option value="N·ªØ">N·ªØ</option>
                        <option value="Kh√°c">Kh√°c</option>
                    </select>
                </div>

                <div class="form-group">
                    <label for="dateOfBirth">Ng√†y sinh</label>
                    <input 
                        type="date" 
                        id="dateOfBirth" 
                        name="dateOfBirth"
                    >
                </div>

                <div class="form-group">
                    <label for="address">ƒê·ªãa ch·ªâ</label>
                    <input 
                        type="text" 
                        id="address" 
                        name="address" 
                        placeholder="Nh·∫≠p ƒë·ªãa ch·ªâ"
                    >
                </div>

                <div class="form-group">
                    <label for="major">Ng√†nh h·ªçc</label>
                    <input 
                        type="text" 
                        id="major" 
                        name="major" 
                        placeholder="VD: C√¥ng ngh·ªá th√¥ng tin"
                    >
                </div>

                <div class="form-group">
                    <label for="class">L·ªõp</label>
                    <input 
                        type="text" 
                        id="class" 
                        name="class" 
                        placeholder="VD: IT01"
                    >
                </div>

                <div class="form-group">
                    <label for="password">M·∫≠t kh·∫©u *</label>
                    <input 
                        type="password" 
                        id="password" 
                        name="password" 
                        placeholder="√çt nh·∫•t 6 k√Ω t·ª±"
                        required
                    >
                </div>

                <div class="form-group">
                    <label for="confirmPassword">X√°c nh·∫≠n m·∫≠t kh·∫©u *</label>
                    <input 
                        type="password" 
                        id="confirmPassword" 
                        name="confirmPassword" 
                        placeholder="Nh·∫≠p l·∫°i m·∫≠t kh·∫©u"
                        required
                    >
                </div>

                <button type="submit" class="btn btn-primary">
                    ƒêƒÉng k√Ω
                </button>
            </form>

            <div class="auth-link">
                ƒê√£ c√≥ t√†i kho·∫£n? <a href="../index.html">ƒêƒÉng nh·∫≠p ngay</a>
            </div>
        </div>
    </div>

    <!-- JavaScript -->
    <script src="../js/storage.js"></script>
    <script src="../js/auth.js"></script>
    <script src="../js/validation.js"></script>
    <script src="../js/utils.js"></script>
    <script>
        // Ki·ªÉm tra n·∫øu ƒë√£ ƒëƒÉng nh·∫≠p th√¨ chuy·ªÉn ƒë·∫øn dashboard
        if (Auth.isAuthenticated()) {
            window.location.href = './dashboard.html';
        }

        // X·ª≠ l√Ω form ƒëƒÉng k√Ω
        document.getElementById('registerForm').addEventListener('submit', function(e) {
            e.preventDefault();

            // L·∫•y d·ªØ li·ªáu form
            const formData = {
                studentId: document.getElementById('studentId').value.trim().toUpperCase(),
                fullName: document.getElementById('fullName').value.trim(),
                email: document.getElementById('email').value.trim(),
                phone: document.getElementById('phone').value.trim(),
                gender: document.getElementById('gender').value,
                dateOfBirth: document.getElementById('dateOfBirth').value,
                address: document.getElementById('address').value.trim(),
                major: document.getElementById('major').value.trim(),
                class: document.getElementById('class').value.trim(),
                password: document.getElementById('password').value,
                confirmPassword: document.getElementById('confirmPassword').value
            };

            // Validate
            const validation = Validation.validateRegisterForm(formData);
            if (!validation.isValid) {
                Utils.showAlert(validation.errors.join('<br>'), 'error');
                return;
            }

            // ƒêƒÉng k√Ω
            const result = Auth.register(formData);
            
            if (result.success) {
                Utils.showAlert(result.message, 'success');
                setTimeout(() => {
                    window.location.href = '../index.html';
                }, 2000);
            } else {
                Utils.showAlert(result.message, 'error');
            }
        });

        // T·ª± ƒë·ªông focus v√†o m√£ sinh vi√™n
        document.getElementById('studentId').focus();
    </script>
</body>
</html>
